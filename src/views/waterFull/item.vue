<template>
	<div>
		<div class="body-wrapper">
			aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
		</div>
		<div class="wrapper" ref="wrapper">
			<div class="md-wrapper">
				<div class="middle-wrapper">
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1345084668,876185986&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3927516496,3793093536&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4092422502,3904595983&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1972266652,2177336411&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=460642919,657115180&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2298007433,3253212770&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2298007433,3253212770&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=460642919,657115180&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1972266652,2177336411&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=4092422502,3904595983&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3927516496,3793093536&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=4124314118,4132248400&fm=27&gp=000.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=750006538,2831865258&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=750006538,2831865258&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=107606063,438385293&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=750006538,2831865258&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=107606063,438385293&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
					<div class="box">
						<div class="pic">
							<img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3927516496,3793093536&fm=27&gp=0.jpg" alt="" onerror="this.onerror=null;this.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'">
						</div>
					</div>
				</div>
			</div>
			<!-- <div class="wrapper-full">			
				<div class="box" v-for="item in rows">
					<div class="pic">
						<img :src="item" alt="">
					</div>
				</div>
				<div class="loading-more"><img v-show="noImg" src="/images/loading.gif" alt="">{{isMore}}
				</div>
			</div> -->
		</div>

	</div>
</template>

<script>
// import Scroll from 'common/components/Scroll.vue'
import BScroll from 'better-scroll'
export default {
	props: {
		"rows": [],
	},
	data() {
		return {
			isMore: '加载更多',
			scrollObj: null,
			noImg: false,
			totalPage: 10,
			p_num: 1,
			rows: [],

			colArr: [],
			pullup: {},
			scroll: {}
		}
	},
	components: {
		BScroll
	},
	created(){
		this.rows = this.$props.rows;
	},
	mounted() {
		let vm = this;
		let $wrapper = document.querySelectorAll(".wrapper");
		let boxArr = $wrapper[0].querySelectorAll(".box");
		// let colArr = [];
		boxArr.forEach(function (item, index) {
			let imgObj = new Image();
			imgObj.src = item.querySelectorAll("img")[0].src;
			imgObj.onload = function () {
				vm.waterFull(item, index);
			}
			imgObj.onerror = function () {
				let imgo = new image();

				imgo.src='https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=2659606272,32100834&fm=27&gp=0.jpg'
				imgo.onload = function(){
					vm.setHeight();
				}
			}
		});
		this.scroll = new BScroll(this.$refs.wrapper, {
		    pullUpLoad: this.pullup
		})
		


	},
	methods: {
		waterFull (item, index) {
			let cacheVal = 0;	//存放小的值
			let cacheIndex = 0;	//存放小值的下标
			if (this.colArr.length >= 2) {

				this.colArr.forEach(function (item1, index1) {
					if (index1 == 0) {
						cacheVal = item1;
					} else {
						if (cacheVal > item1) {
							cacheIndex = 1;
							cacheVal = item1;
						}
					}
				});
				if (cacheIndex) {
					item.style.cssText = 'position: absolute; top: ' + cacheVal + 'px;right: 0;';
				} else {
					item.style.cssText = 'position: absolute; top: ' + cacheVal + 'px;left: 0;';
				}
				this.colArr[cacheIndex] = this.colArr[cacheIndex] + item.offsetHeight;

			} else {

				if (this.colArr.length == 0) {
					item.style.cssText = 'position: absolute; left: 0;';
				}
				if (this.colArr.length == 1) {
					item.style.cssText = 'position: absolute; right: 0;';
				}
				this.colArr.push(item.offsetHeight);
			}
			this.setHeight();
		},
		setHeight () {
			let mWrapper = document.querySelectorAll('.middle-wrapper')[0];
			mWrapper.style.height = ((this.colArr[0] < this.colArr[1]) ? this.colArr[1] : this.colArr[0]) +'px';
			this.$nextTick(()=>{
				console.log((this.colArr[0] < this.colArr[1]) ? this.colArr[1] : this.colArr[0]);
				this.scroll && this.scroll.refresh()
			})

		}

	},
	destroy() {

	}
}
</script>

<style lang="scss" scoped>
	@import '../../common/style/common.scss';
	* {
		padding: 0;
		margin: 0;
	}
	.body-wrapper {
		height: r(300);
		width: 100%;
	}
	.wrapper {
		position: fixed;
		width: r(680);
		margin: 0 auto;
		left: 50%;
		margin-left: r(-340);
		top: r(300);
		bottom: 0;
		overflow: hidden;
	}
	.md-wrapper {
		width: 100%;
	}
	.middle-wrapper {
		width: 100%;
	}
	.box {
		padding: 10px;
	}
	.pic {
		padding: 10px;
		border-radius: 5px;
		border: 1px solid #ccc;
		box-shadow: 0 0 5px #ccc;
		box-sizing: border-box;
		background-color: #fff;
	}
	img {
		width: r(260);
	}

</style>